<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Twitter -->
    <meta name="twitter:site" content="@* @themepixels *@">
    <meta name="twitter:creator" content="@* @themepixels *@">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Amanda">
    <meta name="twitter:description" content="Premium Quality and Responsive UI for Dashboard.">
    <meta name="twitter:image" content="http://themepixels.me/amanda/img/amanda-social.png">

    <!-- Facebook -->
    <meta property="og:url" content="http://themepixels.me/amanda">
    <meta property="og:title" content="Bracket">
    <meta property="og:description" content="Premium Quality and Responsive UI for Dashboard.">

    <meta property="og:image" content="http://themepixels.me/amanda/img/amanda-social.png">
    <meta property="og:image:secure_url" content="http://themepixels.me/amanda/img/amanda-social.png">
    <meta property="og:image:type" content="image/png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="600">

    @* <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"> *@
    <!-- Meta -->
    <meta name="description" content="Premium Quality and Responsive UI for Dashboard.">
    <meta name="author" content="ThemePixels">


    <title>@ViewData["Title"] - MDS Laboratory</title>

    
    <!-- vendor css -->
    @* <link href="@Url.Content("~/lib/font-awesome/css/font-awesome.css")" rel="stylesheet"> *@
    @* <link href="~/lib/Ionicons/css/ionicons.css" rel="stylesheet"> *@
    @* <link href="~/lib/perfect-scrollbar/css/perfect-scrollbar.css" rel="stylesheet"> *@
    @* <link href="~/lib/jquery-toggles/toggles-full.css" rel="stylesheet"> *@
    @* <link href="~/lib/rickshaw/rickshaw.min.css" rel="stylesheet"> *@

    @* <link href="~/lib/highlightjs/github.css" rel="stylesheet"> *@
    @* <link href="~/lib/jquery.steps/jquery.steps.css" rel="stylesheet"> *@

    @* <!-- Amanda CSS --> *@
    @* <link rel="stylesheet" href="~/css/amanda.css"> *@
    <link href="@Url.Content("~/lib/font-awesome/css/font-awesome.css")" rel="stylesheet">
    <link href="@Url.Content("~/lib/Ionicons/css/ionicons.css")" rel="stylesheet">
    <link href="@Url.Content("~/lib/perfect-scrollbar/css/perfect-scrollbar.css")" rel="stylesheet">
    <link href="@Url.Content("~/lib/jquery-toggles/toggles-full.css")" rel="stylesheet">
    <link href="@Url.Content("~/lib/rickshaw/rickshaw.min.css")" rel="stylesheet">
    <link href="@Url.Content("~/lib/highlightjs/github.css")" rel="stylesheet">
    <link href="@Url.Content("~/lib/jquery.steps/jquery.steps.css")" rel="stylesheet">
    <link href="@Url.Content("~/css/amanda.css")" rel="stylesheet">

</head>

<body>

    <div class="am-header">
        <div class="am-header-left">
            <a id="naviconLeft" href="" class="am-navicon d-none d-lg-flex"><i class="icon ion-navicon-round"></i></a>
            <a id="naviconLeftMobile" href="" class="am-navicon d-lg-none"><i class="icon ion-navicon-round"></i></a>
            <a asp-controller="Home" asp-action="Index" class="am-logo">MDS Laboratoriya</a>
        </div><!-- am-header-left -->

        <div class="am-header-right">
            @if (User?.Identity?.IsAuthenticated ?? false)
            {
                <div class="dropdown dropdown-profile">
                    <a href="" class="nav-link nav-link-profile" data-toggle="dropdown">
                    <img src="../img/img3.jpg" class="wd-32 rounded-circle" alt="">
                    <span class="logged-name"><span class="hidden-xs-down">@User.Identity.Name</span> <i class="fa fa-angle-down mg-l-3"></i></span>
                </a>
                <div class="dropdown-menu wd-200">
                    <ul class="list-unstyled user-profile-nav">
                        <li onclick="document.getElementById('logoutForm').submit()" style="cursor: pointer;">
                            <i class="icon ion-power"></i> Выход
                        </li>
                        <form id="logoutForm" asp-controller="Account" asp-action="Logout" method="post" style="display:none;"></form> 
                    </ul>
                </div><!-- dropdown-menu -->
            </div><!-- dropdown -->
            }
        </div><!-- am-header-right -->
    </div><!-- am-header -->

    <div class="am-sideleft">
        <ul class="nav am-sideleft-tab">
            <li class="nav-item" style="width:100%;">
                <a href="#mainMenu" class="nav-link active"><i class="icon ion-ios-home-outline tx-24"></i></a>
            </li>
        </ul>

        <div class="tab-content">
            <div id="mainMenu" class="tab-pane active">
                <ul class="nav am-sideleft-menu">
                    <li class="nav-item">
                        <a asp-controller="Home" asp-action="Index" class="nav-link active">
                            <i class="icon ion-ios-home-outline"></i>
                            <span>Dashboard</span>
                        </a>
                    </li><!-- nav-item -->
                    <li class="nav-item">
                        <a href="" class="nav-link with-sub @((ViewContext.RouteData.Values["Controller"]?.ToString() == "Patient") || (ViewContext.RouteData.Values["Controller"]?.ToString() == "Application")  ? "show-sub" : "")">
                            <i class="icon ion-ios-analytics-outline"></i>
                            <span>Регистрация поциента</span>
                        </a>
                        <ul class="nav-sub">
                            <li class="nav-item"><a asp-controller="Patient" asp-action="Index" class="nav-link">Новый пациент</a></li>
                            <li class="nav-item"><a asp-controller="Application" asp-action="PatientList" class="nav-link">Новая заявка</a></li>
                            @* <li class="nav-item"><a asp-controller="Application" asp-action="PatientApplications" class="nav-link">Список заявок</a></li> *@
                            <li class="nav-item"><a asp-controller="Application" asp-action="ApplicationList" class="nav-link">Список заявок</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a href="" class="nav-link with-sub @((ViewContext.RouteData.Values["Controller"]?.ToString() == "Users") || (ViewContext.RouteData.Values["Controller"]?.ToString() == "Roles") || (ViewContext.RouteData.Values["Controller"]?.ToString() == "AnalyzeTypes")
                                || (ViewContext.RouteData.Values["Controller"]?.ToString() == "Statistics") ? "show-sub" : "")">
                            <i class="icon ion-ios-gear-outline"></i>
                            <span>Администрирование</span>
                        </a>
                        <ul class="nav-sub">
                            <li class="nav-item"><a asp-controller="Users" asp-action="Index" class="nav-link">Пользователи</a></li>
                            <li class="nav-item"><a asp-controller="Roles" asp-action="Index" class="nav-link">Роли</a></li>
                            <li class="nav-item"><a asp-controller="AnalyzeTypes" asp-action="Index" class="nav-link">Платежи и тарифы</a></li>
                            <li class="nav-item"><a asp-controller="AnalyzeCategory" asp-action="Index" class="nav-link">Список категорий</a></li>
                            <li class="nav-item"><a asp-controller="Statistics" asp-action="Index" class="nav-link">Добавить расход</a></li>
                            <li class="nav-item"><a asp-controller="Statistics" asp-action="FinanceReport" class="nav-link">Статистика</a></li>
                            <li class="nav-item"><a asp-controller="Statistics" asp-action="DoctorPayouts" class="nav-link">Выплаты врачам</a></li>
                            @* <li class="nav-item"><a href="form-validation.html" class="nav-link">Form Validation</a></li>
                            <li class="nav-item"><a href="form-wizards.html" class="nav-link">Form Wizards</a></li>
                            <li class="nav-item"><a href="form-editor-text.html" class="nav-link">Text Editor</a></li> *@
                        </ul>
                    </li>
                </ul>
            </div><!-- #mainMenu -->
        </div><!-- tab-content -->
    </div><!-- am-sideleft -->

    <div class="am-mainpanel">
        <div class="am-pagetitle">

        </div><!-- am-pagetitle -->

        <div class="am-pagebody">
            @RenderBody()
        </div><!-- am-pagebody -->
        <div class="am-footer">
            <span>Copyright &copy;. MDS Laboratory 2025.</span>
            <span>version 1.0</span>
        </div><!-- am-footer -->
    </div><!-- am-mainpanel -->

    @* <script src="@Url.Content("~/lib/jquery/jquery.js")"></script> *@
    @* <script src="~/lib/popper.js/popper.js"></script> *@
    @* <script src="~/lib/bootstrap/bootstrap.js"></script> *@
    @* <script src="~/lib/perfect-scrollbar/js/perfect-scrollbar.jquery.js"></script> *@
    @* <script src="~/lib/jquery-toggles/toggles.min.js"></script> *@
    @* <script src="~/lib/d3/d3.js"></script> *@
    @* <script src="~/lib/rickshaw/rickshaw.min.js"></script> *@
   <script src="http://maps.google.com/maps/api/js?key=AIzaSyAEt_DBLTknLexNbTVwbXyq2HSf2UbRBU8"></script>
    @* <script src="~/lib/gmaps/gmaps.js"></script> *@
    @* <script src="~/lib/Flot/jquery.flot.js"></script> *@
    @* <script src="~/lib/Flot/jquery.flot.pie.js"></script> *@
    @* <script src="~/lib/Flot/jquery.flot.resize.js"></script> *@
    @* <script src="~/lib/flot-spline/jquery.flot.spline.js"></script> *@

    @* <script src="~/js/amanda.js"></script> *@
    @* <script src="~/js/ResizeSensor.js"></script> *@
    @* <script src="~/js/dashboard.js"></script> *@


    @* <script src="~/lib/highlightjs/highlight.pack.js"></script> *@
    @* <script src="~/lib/jquery.steps/jquery.steps.js"></script> *@
    @* <script src="~/lib/parsleyjs/parsley.js"></script> *@
    <script src="@Url.Content("~/lib/jquery/jquery.js")"></script>
    <script src="@Url.Content("~/lib/popper.js/popper.js")"></script>
    <script src="@Url.Content("~/lib/bootstrap/bootstrap.js")"></script>
    <script src="@Url.Content("~/lib/perfect-scrollbar/js/perfect-scrollbar.jquery.js")"></script>
    <script src="@Url.Content("~/lib/jquery-toggles/toggles.min.js")"></script>
    <script src="@Url.Content("~/lib/d3/d3.js")"></script>
    <script src="@Url.Content("~/lib/rickshaw/rickshaw.min.js")"></script>
    <script src="@Url.Content("~/lib/gmaps/gmaps.js")"></script>
    <script src="@Url.Content("~/lib/Flot/jquery.flot.js")"></script>
    <script src="@Url.Content("~/lib/Flot/jquery.flot.pie.js")"></script>
    <script src="@Url.Content("~/lib/Flot/jquery.flot.resize.js")"></script>
    <script src="@Url.Content("~/lib/flot-spline/jquery.flot.spline.js")"></script>
    <script src="@Url.Content("~/js/amanda.js")"></script>
    <script src="@Url.Content("~/js/ResizeSensor.js")"></script>
    <script src="@Url.Content("~/js/dashboard.js")"></script>
    <script src="@Url.Content("~/lib/highlightjs/highlight.pack.js")"></script>
    <script src="@Url.Content("~/lib/jquery.steps/jquery.steps.js")"></script>
    <script src="@Url.Content("~/lib/parsleyjs/parsley.js")"></script>

    <script>
      
        $('#wizard2').steps({
            headerTag: 'h3',
            bodyTag: 'section',
            autoFocus: true,
            titleTemplate: '<span class="number">#index#</span> <span class="title">#title#</span>',
            onStepChanging: function (event, currentIndex, newIndex) {
                if (currentIndex < newIndex) {
                    // Step 1 validation: Ensure at least one doctor is selected
                    if (currentIndex === 0) {
                        var isDoctorSelected = $("input[name^='SelectedDoctors']:checked").length > 0;
                        if (!isDoctorSelected) {
                            alert("Пожалуйста, выберите хотя бы одного врача.");
                            return false;
                        }
                    }

                    // Step 2 validation: Ensure at least one analyze is selected
                    if (currentIndex === 1) {
                        var isAnalyzeSelected = $("input[name^='SelectedAnalyzeTypes']:checked").length > 0;
                        if (!isAnalyzeSelected) {
                            alert("Пожалуйста, выберите хотя бы один анализ.");
                            return false;
                        }
                    }

                    // Step 3 validation: Ensure required patient information is filled
                    if (currentIndex === 2) {
                        var fname = $('#firstname').parsley();
                        var lname = $('#lastname').parsley();

                        if (fname.isValid() && lname.isValid()) {
                            return true;
                        } else {
                            fname.validate();
                            lname.validate();
                            alert("Пожалуйста, заполните обязательные поля пациента.");
                            return false;
                        }
                    }
                }

                // Allow moving back to previous steps
                return true;
            },

            onFinished: function (event, currentIndex) {
                // Submit the form
                $('#applicationForm').submit();
            }
        });

            $(document).ready(function(){
            $('[data-toggle="tooltip"]').tooltip(); // Активация tooltips
        });

        // Toggle payment amount input based on payment type selection
        $('#payment-type').on('change', function () {
            if ($(this).val() === 'partial') {
                $('#payment-amount-container').show();
            } else {
                $('#payment-amount-container').hide();
                $('#payment-amount').val('');
            }
        });

    </script>

    @RenderSection("Scripts", required: false)
</body>
</html>
